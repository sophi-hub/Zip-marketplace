var shellPerformance=window.performance,HighResolutionTimingSupported=!!shellPerformance&&"function"==typeof shellPerformance.mark;HighResolutionTimingSupported&&shellPerformance.mark("shell_chat_start"),(self["suiteux_shell_webpackJsonp_suiteux-main"]=self["suiteux_shell_webpackJsonp_suiteux-main"]||[]).push([["chat"],{14647:function(e,t,n){(t=e.exports=n(47632)(!1)).push([e.id,".w4P7LBKjs8s7OCcvAbPoBQ\\=\\={display:inline-block;font-size:19px;vertical-align:middle}",""]),t.locals={icon:"w4P7LBKjs8s7OCcvAbPoBQ=="}},88573:function(e,t,n){var a=n(14647);"string"==typeof a&&(a=[[e.id,a,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(66134)(a,i);a.locals&&(e.exports=a.locals)},29987:function(e,t,n){"use strict";n.d(t,{k:function(){return m},w:function(){return C}});var a=n(64731),i=n(93643),s=n(91011),o=n(58930),r=n(33836),l=n(72607),c=n(88573),u=n(19234),h=n(27676),d=n(82548);let p;const C=e=>{let t=e instanceof MouseEvent;if(e instanceof KeyboardEvent)switch(e.which){case 40:t=e.altKey;break;case 13:case 32:t=!0}t&&function(e){e.preventDefault(),window.open(p),(0,s.jl)().click("ChatButton","NavBar",null,null,"Default chat web page")}(e)};class m extends a.Component{constructor(e){super(e),this.onMouseChange=e=>this.setState({isHovered:e}),this.state={isHovered:!1},p=this.props.chatWebLink}render(){if(!this.props.chatEnabled)return null;let e=this.props.isConsumerShell?"SkypeLogo":"OfficeChat",t=(0,o.j)();const n=this.props.unreadBadgeValue>0?"":null;return a.createElement("button",{type:"button",id:l.vP,className:(0,i.iv)(u.button,t.headerButton),"aria-disabled":"false",title:h.b.Chat,"aria-label":h.b.Chat,role:"button",onMouseEnter:this.onMouseChange.bind(this,!0),onMouseLeave:this.onMouseChange.bind(this,!1)},a.createElement(i.BH,{fontIconCss:`ms-Icon--${e}`,fontSize:d.GX.toString(),className:(0,i.iv)(c.icon),isAriaHidden:!0}),a.createElement(i.Eb,{unseenItemCount:this.props.unreadBadgeValue,isParentHovered:this.state.isHovered,badgeStyles:(0,i.iv)(u.headerButtonBadgePosition),badgeCharacter:n}))}componentDidMount(){(0,i.yw)([l.vP],`${r.t.CLICK} ${r.t.KEYDOWN}`,C)}}},51907:function(e,t,n){"use strict";n.r(t),n.d(t,{ChatHeaderButtonConnector:function(){return P},ChatIconConnector:function(){return A},initializeChatComponent:function(){return E}});var a=n(64731),i=n(25445),s=n(61371),o=n(30884),r=n(91011),l=n(77224);const c=(0,n(3073).k)((()=>n.e("chatbase").then(n.bind(n,62387)).then((e=>e.ChatBaseControlConnector))));class u extends a.Component{constructor(e){super(e),this.state={shouldPreAuth:!1}}render(){const{shouldPreAuth:e}=this.state;return this.props.shouldInitChatOnFirstClick||e?a.createElement(c,null):null}componentDidMount(){this.fetchShouldPreAuth()}fetchShouldPreAuth(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(yield this.props.isTeamsAvailable){const e=yield this.props.shouldLoadEmbedChatPreAuthOnIdle;this.setState({shouldPreAuth:e})}}))}}const h=(0,s.connect)((e=>{const t=e.shellInitDataState;return{shouldInitChatOnFirstClick:e.chatState.initChatOnFirstClick,shouldLoadEmbedChatPreAuthOnIdle:t.renderSettings.shouldLoadEmbedChatPreAuthOnIdle,isTeamsAvailable:t.renderSettings.shouldEnableChat}}))(u);var d=n(93643),p=n(47487),C=n(70163),m=n(44552),b=n(82548),f=n(19234),v=n(27676);class g extends a.Component{constructor(e){super(e),this.chatEnablementPromise=null,this.state={isHovered:!1,delayRender:!!e.shouldEnableChat}}componentDidMount(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(this.state.delayRender){this.chatEnablementPromise=(0,p.W)(this.props.shouldEnableChat);try{const e=yield this.chatEnablementPromise.promise;this.setState({delayRender:!e})}catch(e){e&&!e.isCancelled&&(0,r.jl)().exception("Chat_Delay_Initialization_Failed",6,e)}}this.props.isAvailable&&(0,r.jl)().perfMarker("ChatTimeToInteractive")}))}componentWillUnmount(){var e;null===(e=this.chatEnablementPromise)||void 0===e||e.cancel()}getAriaLabel(){let e=v.b.Chat;return void 0!==this.props.unseenItemCount&&0!==this.props.unseenItemCount&&(e=v.b.ChatUnreadItems),e}render(){if(!this.props.chatEnabled||this.state.delayRender)return null;const e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:this.getAriaLabel(),affordanceMenuItemText:v.b.Chat,iconID:this.props.isConsumerShell?"SkypeLogo":"OfficeChat",iconFontSize:b.GX.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onHoverStateChanged:e=>{this.setState({isHovered:e})},onDimensionsChanged:this.props.controlDimensionsChanged},t=this.props.unseenItemCount>0?"":null;return 0===this.props.renderContext?a.createElement(C.sO,Object.assign({},e),a.createElement(d.Eb,{unseenItemCount:this.props.unseenItemCount,isParentHovered:this.state.isHovered,badgeStyles:f.headerButtonBadgePosition,badgeCharacter:t})):a.createElement(C.b,Object.assign({},e),a.createElement(d.Eb,{unseenItemCount:this.props.unseenItemCount,isParentHovered:this.state.isHovered,badgeStyles:m.affordanceContextMenuItemBadgePosition,badgeCharacter:t}))}}var S=n(74213),I=n(51932);const P=(0,s.connect)(((e,t)=>{var n,a;let i=function(e){let t=!1,n=!1;e.chatState.chatEnabled&&(t=!e.shellInitDataState.renderSettings.initChatOnPageLoad,null!==e.chatState.isChatAPIInitialized&&(e.chatState.isChatAPIInitialized?t=!0:e.userState.isConsumer&&(t=!0,n=!0)));return{showButton:t,useButtonAsLink:n}}(e);return{isAvailable:i.showButton,id:t&&t.id,isActive:null!==(n=e.chatState&&e.chatState.isChatRecentsPaneOpen)&&void 0!==n&&n,useButtonAsLink:i.useButtonAsLink,chatWebLink:e.chatState&&e.chatState.chatWebLink,chatEnabled:e.chatState&&e.chatState.chatEnabled,isConsumerShell:null===(a=e.shellInitDataState.clientData)||void 0===a?void 0:a.IsConsumerShell,controlDimensionsChanged:t.controlDimensionsChanged,isChatRecentsPaneInitialized:e.chatState.isChatRecentsPaneInitialized,isChatAPIInitialized:e.chatState.isChatAPIInitialized,unseenItemCount:e.chatState.unreadBadgeValue,shouldEnableChat:e.shellInitDataState.renderSettings.shouldEnableChat}}),(e=>({onClick:(t,n)=>{t.stopPropagation(),(0,r.jl)().click("ChatButton","NavBar",null,null,`Active state: ${n.isActive}, Render context: ${n.renderContext}, Use Button as Link: ${n.useButtonAsLink}`),n.onClick&&n.onClick(t),n.useButtonAsLink?(t.preventDefault(),window.open(n.chatWebLink)):(n.isChatAPIInitialized?n.isChatRecentsPaneInitialized||(0,I.UN)((()=>{e((0,S.Lc)(!0))}),((t,n)=>{e((0,S.ik)(t)),e((0,d.uS)(n))})):e((0,S.NL)(!0)),e((0,S.ik)(!n.isActive)),e((0,d.uS)(t.currentTarget&&t.currentTarget.id)))}})),((e,t,n)=>{let a=Object.assign(Object.assign({},n),e);return Object.assign(Object.assign(Object.assign({},a),t),{onClick:e=>t.onClick(e,a),onDimensionsChanged:()=>t.onDimensionsChanged(a)})}))(g);var k=n(29987);const A=(0,s.connect)((e=>({unreadBadgeValue:e.chatState.unreadBadgeValue,chatEnabled:e.chatState.chatEnabled,chatWebLink:e.chatState.chatWebLink,isConsumerShell:e.shellInitDataState&&e.shellInitDataState.clientData.IsConsumerShell})))(k.k);function E(){const e=document.createElement("div");document.getElementById((0,r.aH)().top).appendChild(e);const t=(0,o.e)();i.render(a.createElement(s.Provider,{store:t},a.createElement(h,null)),e)}},74213:function(e,t,n){"use strict";n.d(t,{Lc:function(){return o},NL:function(){return d},e$:function(){return r},ik:function(){return s},pA:function(){return c},uA:function(){return u},ug:function(){return h},xg:function(){return l}});var a=n(36198),i=n(40719);function s(e){return{type:a.__,isRecentsOpen:e}}function o(e){return{type:i.q,isRecentsInitialized:e}}function r(e){return{type:i.D,isChatAPIInitialized:e}}function l(e){return{type:i.P7,isChatAPIPreAuthCompleted:e}}function c(e){return{type:i.nZ,unreadBadgeValue:e}}function u(e){return{type:i.YI,isTeamsChatActivated:e}}function h(){return{type:i.M3}}function d(e){return{type:i.Ak,initChatOnFirstClick:e}}}}]),HighResolutionTimingSupported&&(shellPerformance.mark("shell_chat_end"),shellPerformance.measure("shell_chat","shell_chat_start","shell_chat_end"));